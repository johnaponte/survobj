<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="survobj">
<title>Simulating trials with multiple events • survobj</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating trials with multiple events">
<meta property="og:description" content="survobj">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">survobj</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example_distributions.html">Defining and using objects of class SURVIVAL</a>
    <a class="dropdown-item" href="../articles/simulation_distributions.html">Simulation of survival times</a>
    <a class="dropdown-item" href="../articles/simulation_recurent.html">Simulating trials with multiple events</a>
    <a class="dropdown-item" href="../articles/simulation_trials.html">Simulating trials with survival endpoints</a>
    <a class="dropdown-item" href="../articles/simulation_trials2.html">Simulation trials: non-proportional hazard</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/johnaponte/survobj/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulating trials with multiple events</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/johnaponte/survobj/blob/HEAD/vignettes/simulation_recurent.Rmd" class="external-link"><code>vignettes/simulation_recurent.Rmd</code></a></small>
      <div class="d-none name"><code>simulation_recurent.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://johnaponte.github.io/survobj/">survobj</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document presents a way to simulate a trial with multiple events
and compare the empirical power of the analysis of the first or only
episode using Cox regression and the analysis of multiple episodes under
an Andersen and Gill model. Data is generated using a renewal
homogeneous Poisson process as described <span class="citation">Leemis
(1987)</span> .</p>
</div>
<div class="section level2">
<h2 id="trial-simulation">Trial simulation<a class="anchor" aria-label="anchor" href="#trial-simulation"></a>
</h2>
<p>A total of 1000 trials are simulated using a survival object of class
Weibull with shape of 0.5 and failure rate at time 1 of 40%. Each group
will include 250 participants, and the hazard ratio (HR) for the
intervention group will be 0.7 and the follow-up will be censored at
time 1. Empirical power is defined as the proportion of trials with a
robust p-value below 0.05</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsim</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="va">s_obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/s_weibull.html">s_weibull</a></span><span class="op">(</span>fail <span class="op">=</span> <span class="fl">0.4</span>, t<span class="op">=</span><span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">250</span></span>
<span><span class="va">subjid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">*</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmax</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">set.seed</span> <span class="op">=</span> <span class="fl">12345</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># simulate survival times for one trial</span></span>
<span>    <span class="va">tsim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/SURVIVAL.html">rsurvhr</a></span><span class="op">(</span><span class="va">s_obj</span>, <span class="va">hr</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="kw">while</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tsim</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">tmax</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">i</span> <span class="op">=</span> <span class="va">i</span><span class="op">+</span><span class="fl">1</span></span>
<span>      <span class="va">tsim</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">tsim</span>,<span class="fu"><a href="../reference/renewal.html">renewhr</a></span><span class="op">(</span><span class="va">s_obj</span>, <span class="va">hr</span>, <span class="va">tsim</span><span class="op">[</span>,<span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># Analysis data.frame</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      subjid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">subjid</span>,<span class="va">i</span><span class="op">)</span>,</span>
<span>      group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">i</span><span class="op">)</span>,</span>
<span>      time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">tsim</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">subjid</span>, <span class="va">time</span><span class="op">)</span>  <span class="op">|&gt;</span>  </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">subjid</span><span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ncase <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">time</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">start</span> <span class="op">&lt;</span> <span class="va">tmax</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>event <span class="op">=</span> <span class="fu"><a href="../reference/censor_event.html">censor_event</a></span><span class="op">(</span><span class="va">tmax</span>, <span class="va">time</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fu"><a href="../reference/censor_event.html">censor_time</a></span><span class="op">(</span><span class="va">tmax</span>, <span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Analysis multiple episodes</span></span>
<span>    <span class="va">mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">start</span>,<span class="va">end</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">group</span>, </span>
<span>                method <span class="op">=</span> <span class="st">"breslow"</span>,  </span>
<span>                id <span class="op">=</span> <span class="va">subjid</span>, </span>
<span>                robust <span class="op">=</span> <span class="cn">T</span>,  </span>
<span>                data <span class="op">=</span> <span class="va">df</span>,</span>
<span>                control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.control.html" class="external-link">coxph.control</a></span><span class="op">(</span>timefix <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Analysis first or only episode</span></span>
<span>    <span class="va">sing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">start</span>,<span class="va">end</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="va">group</span>, </span>
<span>                method <span class="op">=</span> <span class="st">"breslow"</span>,  </span>
<span>                id <span class="op">=</span> <span class="va">subjid</span>, </span>
<span>                robust <span class="op">=</span> <span class="cn">T</span>,  </span>
<span>                data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">ncase</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.control.html" class="external-link">coxph.control</a></span><span class="op">(</span>timefix <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span>    </span>
<span>    <span class="co"># Export results for analysis</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      simid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">x</span><span class="op">)</span>,</span>
<span>      res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"recurrent"</span>,<span class="st">"single"</span><span class="op">)</span>,</span>
<span>      events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mult</span><span class="op">$</span><span class="va">nevent</span>, <span class="va">sing</span><span class="op">$</span><span class="va">nevent</span><span class="op">)</span>,</span>
<span>      hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mult</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"exp(coef)"</span><span class="op">]</span>,<span class="va">sing</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"exp(coef)"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      pvalue <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mult</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"Pr(&gt;|z|)"</span><span class="op">]</span>,<span class="va">sing</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"Pr(&gt;|z|)"</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Join all the simulations in a single data frame</span></span>
<span><span class="va">sim_rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sim</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis-of-the-simulation">Analysis of the simulation<a class="anchor" aria-label="anchor" href="#analysis-of-the-simulation"></a>
</h2>
<div class="section level3">
<h3 id="for-recurrent-events">For recurrent events<a class="anchor" aria-label="anchor" href="#for-recurrent-events"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec_empirical_power</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">pvalue</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"recurrent"</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">pval</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"recurrent"</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rec_empirical_power</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="co">#&gt; probability of success </span></span>
<span><span class="co">#&gt;                  0.801</span></span>
<span><span class="va">rec_empirical_power</span><span class="op">$</span><span class="va">conf.int</span></span>
<span><span class="co">#&gt; [1] 0.7748841 0.8253299</span></span>
<span><span class="co">#&gt; attr(,"conf.level")</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span>
<span></span>
<span><span class="co"># Distribution of the simulated VEs}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">hr</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"recurrent"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.3901  0.6025  0.6644  0.6731  0.7359  1.0877</span></span>
<span></span>
<span><span class="co"># Distribution of the simulated number of events</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">events</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"recurrent"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   191.0   233.0   246.0   245.7   258.0   303.0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="for-first-or-only-event">For first or only event<a class="anchor" aria-label="anchor" href="#for-first-or-only-event"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sing_empirical_power</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">pvalue</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"single"</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">pval</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"single"</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sing_empirical_power</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="co">#&gt; probability of success </span></span>
<span><span class="co">#&gt;                  0.672</span></span>
<span><span class="va">sing_empirical_power</span><span class="op">$</span><span class="va">conf.int</span></span>
<span><span class="co">#&gt; [1] 0.6419273 0.7010560</span></span>
<span><span class="co">#&gt; attr(,"conf.level")</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span>
<span></span>
<span><span class="co"># Distribution of the simulated VEs}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">hr</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"single"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.4196  0.6243  0.6934  0.7012  0.7713  1.0931</span></span>
<span></span>
<span><span class="co"># Distribution of the simulated number of events</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">events</span><span class="op">[</span><span class="va">sim_rec</span><span class="op">$</span><span class="va">res</span> <span class="op">==</span> <span class="st">"single"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   143.0   168.0   175.0   175.1   183.0   212.0</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-leemis1987" class="csl-entry">
Leemis, Lawrence M. 1987. <span>“Variate Generation for Accelerated Life
and Proportional Hazards Models.”</span> <em>Operations Research</em> 35
(6): 892–94.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Aponte John.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
